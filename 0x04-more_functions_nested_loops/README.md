This is low level programmking most nested loop function